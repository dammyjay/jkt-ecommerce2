<!-- <div class="container">
  <h1>Manage Testimonials</h1>

  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
    <% testimonials.forEach(testimonial => { %>
      <div class="card" style="padding: 20px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
        <p>"<%= testimonial.message %>"</p>
        <p style="font-weight: 600; margin-top: 10px;">- <%= testimonial.name %></p>
        <p style="font-size: 0.85rem; color: gray;">Submitted: <%= new Date(testimonial.created_at).toLocaleString() %></p>

        <% if (!testimonial.is_approved) { %>
          <form action="/admin/testimonials/<%= testimonial.id %>/approve" method="POST" style="margin-top: 10px;">
            <button type="submit" class="btn btn-primary btn-sm">Approve</button>
          </form>
        <% } else { %>
          <form action="/admin/testimonials/<%= testimonial.id %>/unapprove" method="POST" style="margin-top: 10px;">
            <button type="submit" class="btn btn-secondary btn-sm">Unapprove</button>
          </form>
        <% } %>
      </div>
    <% }) %>
  </div>
</div> -->


<div class="container">
  <h1>Manage Testimonials</h1>

  <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:20px; margin-top:20px;">
    
    <% testimonials.forEach(testimonial => { %>
      <div class="card" style="padding:20px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1);">

        <!-- Avatar, Name & Rating (STACKED) -->
        <div style="display:flex; flex-direction:column; align-items:center; text-align:center;">

          <% if (testimonial.image_url) { %>
            <img 
              src="<%= testimonial.image_url %>" 
              alt="<%= testimonial.name %>" 
              style="width:70px; height:70px; border-radius:50%; object-fit:cover; margin-bottom:8px;"
            >
          <% } else { %>
            <div 
              style="
                width:70px;
                height:70px;
                border-radius:50%;
                background:#eee;
                display:flex;
                align-items:center;
                justify-content:center;
                font-size:24px;
                font-weight:600;
                margin-bottom:8px;
              "
            >
              <%= testimonial.name.charAt(0).toUpperCase() %>
            </div>
          <% } %>

          <p style="font-weight:600; margin:0;">
            <%= testimonial.name %>
          </p>

          <!-- Star Rating -->
          <div style="color:#f5a623; margin-top:4px;">
            <% for (let i = 1; i <= 5; i++) { %>
              <% if (i <= testimonial.rating) { %>
                ★
              <% } else { %>
                ☆
              <% } %>
            <% } %>
          </div>

        </div>

        <!-- Message -->
        <p style="margin-top:14px; font-style:italic; text-align:center;">
          "<%= testimonial.message %>"
        </p>

        <p style="font-size:0.8rem; color:gray; text-align:center;">
          Submitted: <%= new Date(testimonial.created_at).toLocaleString() %>
        </p>

        <!-- Approve / Unapprove -->
        <div style="display:flex; justify-content:center; margin-top:10px;">
          <% if (!testimonial.is_approved) { %>
            <form action="/admin/testimonials/<%= testimonial.id %>/approve" method="POST">
              <button class="btn btn-primary btn-sm">Approve</button>
            </form>
          <% } else { %>
            <form action="/admin/testimonials/<%= testimonial.id %>/unapprove" method="POST">
              <button class="btn btn-secondary btn-sm">Unapprove</button>
            </form>
          <% } %>
        </div>

      </div>
    <% }) %>

  </div>
</div>
